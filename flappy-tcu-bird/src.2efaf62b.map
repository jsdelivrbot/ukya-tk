{"version":3,"sources":["src/index.js"],"names":["phina","globalize","define","superClass","init","superInit","backgroundColor","interval","time","score","player","Sprite","addChildTo","setPosition","gridX","center","gridY","setSize","setScale","physical","gravity","y","setInteractive","update","pipes","DisplayElement","onpointstart","velocity","scoreLabel","Label","text","fontSize","app","position","height","exit","deltaTime","addRowOfPipes","addOnePipe","x","pipeSize","pipe","playerCollision","Circle","radius","hitTestElement","hole","Math","floor","random","i","width","titleLabel","params","shareButton","onclick","url","social","Twitter","createURL","hashtags","window","open","main","GameApp","startLabel","assets","image","bird","require","run"],"mappings":"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","file":"src.2efaf62b.map","sourceRoot":"..","sourcesContent":["phina.globalize();\n\nphina.define(\"MainScene\", {\n  superClass: \"DisplayScene\",\n  init: function() {\n    this.superInit();\n\n    this.backgroundColor = \"lightblue\";\n\n    this.interval = 2500;\n    this.time = this.interval;\n\n    this.score = 0;\n\n    this.player = Sprite(\"bird\")\n      .addChildTo(this)\n      .setPosition(this.gridX.center(), this.gridY.center())\n      .setSize(128, 128)\n      .setScale(-1, 1);\n\n    this.player.physical.gravity.y = 1.0;\n\n    this.player.setInteractive(true);\n\n    this.player.update = () => {};\n\n    this.pipes = DisplayElement().addChildTo(this);\n\n    this.onpointstart = () => {\n      this.player.physical.velocity.y = -15.0;\n    };\n\n    this.scoreLabel = Label({\n      text: `SCORE:${this.score}`,\n      fontSize: 24\n    })\n      .addChildTo(this)\n      .setPosition(60, 20);\n  },\n  update: function(app) {\n    if (this.player.position.y > this.height) {\n      this.exit({ score: this.score });\n    }\n    if (this.player.position.y < 0) {\n      this.player.position.y = 0;\n    }\n    // if (Math.floor(app.elapsedTime / 100) % 30 === 0) {\n    //   this.addRowOfPipes();\n    // }\n    this.scoreLabel.text = `SCORE:${this.score}`;\n\n    this.time -= app.deltaTime;\n    if (this.time < 0) {\n      this.time = this.interval;\n      this.addRowOfPipes();\n      this.score++;\n    }\n  },\n  addOnePipe: function(x, y) {\n    const pipeSize = this.height / 8;\n    const pipe = Sprite(\"pipe\")\n      .setSize(pipeSize, pipeSize)\n      .setPosition(x, y)\n      .addChildTo(this);\n\n    pipe.addChildTo(this.pipes);\n\n    pipe.physical.velocity.x = -5.0;\n\n    pipe.update = () => {\n      const playerCollision = Circle(\n        this.player.x,\n        this.player.y,\n        this.player.radius * 0.7\n      );\n      if (pipe.hitTestElement(playerCollision)) {\n        this.exit({ score: this.score });\n      }\n    };\n  },\n  addRowOfPipes: function() {\n    const hole = Math.floor(Math.random() * 5) + 1;\n    for (let i = 0; i < 8; i++)\n      if (i !== hole && i !== hole + 1)\n        this.addOnePipe(this.width, (i * this.height) / 8 + this.height / 16);\n  }\n});\n\nphina.define(\"TitleScene\", {\n  superClass: \"TitleScene\",\n  init: function() {\n    this.superInit();\n    this.titleLabel.text = \"Flappy TCU Bird\";\n  }\n});\n\nphina.define(\"ResultScene\", {\n  superClass: \"ResultScene\",\n  init: function(params) {\n    this.superInit(params);\n    this.shareButton.onclick = () => {\n      const url = phina.social.Twitter.createURL({\n        text: `Flappy TCU Bird Score:${params.score}`,\n        hashtags: [],\n        url: params.url\n      });\n      window.open(url, \"share window\", \"width=480, height=320\");\n    };\n  }\n});\n\nphina.main(function() {\n  const app = GameApp({\n    startLabel: \"title\",\n    assets: {\n      image: {\n        bird: require(\"./images/tcu_bird.png\"),\n        pipe: require(\"./images/logo.jpg\")\n      }\n    }\n  });\n  app.run();\n});\n"]}